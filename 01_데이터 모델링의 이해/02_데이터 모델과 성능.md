# 01_데이터 모델링의 이해

## 2. 데이터 모델과 성능

### 성능데이터모델링

데이터베이스 성능 향상을 목적으로 설계단계의 데이터 몰델링 때부터 성능과 관련된
사항이 데이터 모델링에 반영될 수 있도록 하는 것이다.

### 성능 데이터 모델링 수행 절차

1. 데이터모델링을 할 때 정규화를 정확하게 수행한다.

2. 데이터베이스 용량산정을 수행한다.

3. 데이터베이스에 발생되는 트랜잭션의 유형을 파악한다.

    - 트랜잭션 : 쪼갤 수 없는 업무 처리의 최소 단위

4. 용량과 트랜잭션의 유형에 따라 반정규화(역정규화)를 수행한다.

5. 이력모델의 조정, PK/FK조정, 슈퍼타입/서브타입 조정 등을 수행한다.

    - 슈퍼타입 : 공통의 부분

    - 서브타입 : 공통으로부터 상속받아서

6. 성능관점에서 데이터모델을 검증한다.

### 정규화

데이터베이스의 설계를 재구성하는 테크닉

- 불필요한 데이터 제거

- 삽입/갱신/삭제 시 발생할 수 있는 각종 이상현상들을 방지

- "논리적"으로 데이터를 저장 - 데이터 테이블의 구성이 논리적이고 직관적

#### 1차 정규화

테이블의 컬럼이 원자값(하나의 값)을 갖도록 테이블을 분해하는 것

|이름|나이|좋아하는 음식|
|---|---|---|
|장영|25|떡볶이, 쌀국수|
|이진|25|돈까스|
|주혜|24|소고기|
|정희|24|치킨|

🔻

|이름|나이|좋아하는 음식|
|---|---|---|
|장영|25|떡볶이|
|장영|25|쌀국수|
|이진|25|돈까스|
|주혜|24|소고기|
|정희|24|치킨|

#### 2차 정규화

1차 정규화를 진행한 테이블에 대해 완전 함수 종속을 만족하도록 테이블을 분해하는것

- 완전 함수 종속 : 기본키의 부분집합이 결정자가 되어선 안된다는 것

|이름|좋아하는 음식|
|---|---|
|장영|떡볶이|
|장영|쌀국수|
|이진|돈까스|
|주혜|소고기|
|정희|치킨|

|이름|나이|
|---|---|
|장영|25|
|장영|25|
|이진|25|
|주혜|24|
|정희|24|

#### 3차 정규화

2차 정규화를 진행한 테이블에 대해 이행적 종속을 없애도록 테이블을 분해 하는 것

이행적 종속 : A -> B, B -> C가 성립할 때 A -> C가 성립되는 것을 의미

|이름|나이|도시|Zip code|
|---|---|---|---|
|장영|25|제주|01234|
|장영|25|제주|01234|
|이진|25|서울|56789|
|주혜|24|부산|13579|
|정희|24|강릉|24681|

🔻

|이름|나이|
|---|---|
|장영|25|
|장영|25|
|이진|25|
|주혜|24|
|정희|24|

|Zip code|도시|
|---|---|
|01234|제주|
|01234|제주|
|56789|서울|
|13579|부산|
|24681|강릉|

#### BCNF (Boyce-Codd Normal Form)

3차 정규화를 진행한 테이블에 대해 모든 결정자가 후보키가 되어 테이블을 분해하는 것

|이름|과목|교수님|학점|
|---|---|---|---|
|장영|말과승마|Dr.김|A|
|장영|데이터베이스|Dr.윤|B|
|이진|운영체제|Dr.임|B+|
|주혜|모바일프로그래밍|Dr.최|A+|
|정희|사물인터넷|Dr.고|C+|

🔻

|이름|과목|학점|
|---|---|---|
|장영|말과승마|A|
|장영|데이터베이스|B|
|이진|운영체제|B+|
|주혜|모바일프로그래밍|A+|
|정희|사물인터넷|C+|

|교수님|과목|
|Dr.김|말과승마|
|Dr.윤|데이터베이스|
|Dr.임|운영체제|
|Dr.최|모바일프로그래밍|
|Dr.고|사물인터넷|

### 반정규화

- 정규화된 엔터티, 속성, 관계에 대해 시스템의 성능향상과 개발과 운영의 단순화를 위해
    중복, 통합, 분리 등을 수행하는 데이터 모델링의 기법

- 데이터를 중복하여 성능을 향상시키기 위한 기법

- 반정규화를 적용하는 이유

    - 데이터를 조회할 때 디스크 I/O량이 많아서 성능이 저하되거나 경로가 너무 멀어 조인으로
        인한 성능저하가 예상되거나 칼럼을 계산하여 읽을 때 성능이 저하될 것이 예상되는 경우

### 반정규화 절차

1. 반정규화 대상조사

    - 범위처리빈도수 조사

    - 대량의 범위 처리 조사

    - 통계성 프로세스 조사

    - 테이블 조인 개수

2. 다른 방법유도 검토

    - 뷰(VIEW) 테이블

    - 클러스터링 적용

    - 인덱스의 적용

    - 응용애플리케이션

3. 반정규화 적용

    - 테이블 반정규화

    - 속성의 반정규화

    - 관계의 반정규화

### 반정규화의 대상에 대해 다른 방법으로 처리하는 법

- 지나치게 많은 조인이 걸려 데이터를 조회하는 작업이 기술적으로 어려울 경우
    뷰(VIEW)를 사용하면 이를 해결할 수도 있다.

- 대량의 데이터처리나 부분처리에 의해 성능이 저하되는 경우에 클러스터링을 적용하거나 
    인덱스를 조정함으로써 성능을 향상시킬 수 있다.

- 대량의 데이터는 Primary Key의 성격에 따라 부분적인 테이블로 분리할 수 있다.
    즉 파티셔닝 기법(Partitioning)이 적용되어 성능저하를 방지할 수 있다.

- 응용 애플리케이션에서 로직을 구사하는 방법을 변경함으로써
    성능을 향상시킬 수 있다.

### 슈퍼/서브 타입 데이터 모델의 변환기술

- 개별로 발생되는 트랜잭션에 대해서는 개별 테이블로 구성

- 슈퍼타입 + 서브타입에 대해 발생되는 트랜잭션에 대해서는 슈퍼타입+서브타입 테이블로 구성

- 전체를 하나로 묶어 트랜잭션이 발생할 때는 하나의 테이블로 구성

### PK순서를 결정하는 기준

- 인덱스 정렬구조를 이해한 상태에서 인덱스를 효율적으로 이용할 수 있도록 PK순서를 지정해야 한다.

- 인덱스의 특징은 여러개의 속성이 하나의 인덱스로 구성되어 있을때 앞쪽에 위치한 속성의 값이 
    비교자로 있어야 좋은 효율을 낼 수 있다.

- 앞쪽에 위치한 속성 값이 가급적 '=' or 범위 'between', '<>'이 들어와야 인덱스를 효율적으로 이용할 수 있다

### 분산데이터베이스

- 장점

    - 지역 자치성, 점증적 시스템 용량 확장

    - 신뢰성과 가용성

    - 효용성과 융통성

    - 빠른 응답 속도와 통신비용 절감

    - 데이터의 가용성과 신뢰성 증가

    - 시스템 규모의 적절한 조절

    - 각 지역 사용자의 요구 수용 증대

- 단점

    - 소프트웨어 개발 비용

    - 오류의 잠재성 증대

    - 처리 비용의 증대

    - 설계, 관리의 복잡성과 비용

    - 불규칙한 응답 속도

    - 통제의 어려움

    - 데이터 무결성에 대한 위협